library(shiny)
library(shinythemes)
library(Seurat)
library(uwot)
#setwd("/home/mlp24")

set_1 <- readRDS("")

data_list = list(set_1=set_1)
ui <- fluidPage(
  
  # Application title
  titlePanel("scRNAseq data browser"),
  
  fluidRow(
    column(4,
           
           sidebarPanel(
             radioButtons("dataset", label = h3("Dataset"),
                          choices = list("sample1" = "set_1", "sample2" = "set_2"),
                          selected = "set_1"),
             helpText("Enter gene names in CAPS.  Gene names must be exact."),
             textInput("gene2", label = "Gene Name", value = "GAPDH")
             
           )
    ),
    column(8,
           column(6, 
                  mainPanel(
                    plotOutput("dimPlot1", width = "150%"),
                    plotOutput("genePlot2", width = "150%"),
                    plotOutput("dimPlot3", width =  "150%")
                  )
           )
    ),
    sidebarPanel("Gene Selection", 
                 selectInput('var', 'Choose a gene for more information',
                             choices = c('CD24'= " CD24 is a signal transducer that is belived to play a role in cell differentiation. It also promotes AG-dependent proliferation of B cells and prevents the terminal differentiation into antibody forming cells ", 'TMSB15A'= "is involved in cytoskeleton organisation via binding to actin monomors and inhibiting actin polymerisation", 'NEUROD6'= "This is gene NEUROD6", 'SOX11'= " SOX11 is a transcriptional activator of TEAD2, binds to gene promoters with POU3F2/BRN2 or PIU3F1/OCT6 and plays a role in cell survival in developing tiiue. More specifically in tissues such as the neural tube, branchial arches and somites",
                                         'DCX'= "DCX is a microtubule-associated protein invovled in neuronal dispersion and cortex lamination during cerebral cortex development. May also be involved in the promotion of neuronal migration", 'S100A11' ="Allows for the differentiation and cornification of keratinocytes", 'SRGN' = "Involved in the formation of mast cell secretory granule. Necessary for storage of some proteases in connective tissue and mucosal mast cells, and for storage of granzyme B in T-lymphocytes. Also involved in the localisation of neutrophil elastase in azurophil granules of neutrophils. Mediates processing of MMP2. Involved in cytotoxic cell granule-mediated apoptosis.", 'BZM' = "This is gene B2M", 'ARHGDIB'  = "This is gene ARHGDIB", 
                                         'GABRA1'  = "This is gene GABRA1", 'GABRG2'  = "This is gene GABRG2", 'SNAP25' = "This is gene SNAP25", 'TMEM130' = "This is gene TMEM130", 
                                         'SYNPR' = "This is gene SYNPR", 'CKMT1B' = "This is gene CKMT1B", 'MEG3' = "This is gene MEG3", 'UNC80' = "This is gene UNC80", 'AHI1' = "This is gene AHI1", 
                                         'EEF1A1' = "This is gene EEF1A1", 'ACSBG1' = "This is gene ACSBG1", 'SLC39A12' = "This is gene SLC39A12", 'AGXT2L1' = "This is gene AGXT2L1", 'GJB6' = "This is gene GJB6",
                                         'PRODH' = "This is gene PRODH", 'MAG' = "This is gene MAG", 'KLK6' = "This is gene KLK6", '9JB1' = "This is gene 9JB1", 'CNDP1' = "This is gene CNDP1", 'CARN1' = "This is gene CARN1"),
                             selected = "", multiple = FALSE), 
                 radioButtons("CD24", "Select a specific gene", list("Test1", "Test2"), "")#Gene CD24 - from cluster 1" ))
    )
  )
)


server <- function(input, output, session) {
  
  datasetInput <- reactive({
    df <- data_list[[input$dataset]]
    })
  
  output$dimPlot1 <- renderPlot({
    DimPlot(datasetInput(), reduction = "umap", label =T)
  })
  
  output$genePlot2 <- renderPlot({
    FeaturePlot(datasetInput(), features = (input$gene2), reduction = "umap")
  })
  
  # output$dimPlot3 <- renderPlot({
  #   Dimplot(pmbc, reduction = "umap")
  # })
}

shinyApp(ui, server)  
